accessLog:
  filePath: /var/log/traefik/access.log

entryPoints:
  tcp:
    address: ':8080'
    forwardedHeaders:
      trustedIPs:
        - 127.0.0.0/32
{%- for ip in trusted_ips_cidrs %}
        - {{ ip }}
{%- endfor %}
    proxyProtocol:
      trustedIPs:
        - 127.0.0.0/32
{%- for ip in trusted_ips_cidrs %}
        - {{ ip }}
{%- endfor %}

  tcp-secure:
    address: ':8443'
    forwardedHeaders:
      trustedIPs:
        - 127.0.0.1/32
{%- for ip in trusted_ips_cidrs %}
        - {{ ip }}
{%- endfor %}
    proxyProtocol:
      trustedIPs:
        - 127.0.0.0/32
{%- for ip in trusted_ips_cidrs %}
        - {{ ip }}
{%- endfor %}

{%- for p in projects %}
  {% for s in p.services %}
  {{ Protocol(s.protocol).value }}-{{ s.hostport }}:
    address: ':{{ s.hostport }}/{{ Protocol(s.protocol).value }}'
    forwardedHeaders:
      trustedIPs:
        - 127.0.0.1/32
    {%- for ip in trusted_ips_cidrs %}
        - {{ ip }}
    {%- endfor %}
    proxyProtocol:
      trustedIPs:
        - 127.0.0.0/32
    {%- for ip in trusted_ips_cidrs %}
        - {{ ip }}
    {%- endfor %}
  {%- endfor %}
{%- endfor %}

log:
  level: DEBUG

providers:
  file:
    directory: /etc/traefik/dynamic/
    watch: true
